
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [-4.0387518435038885, -13.680625121740803, 61.043892784595272, 80.327639341069101, 5.8709512480173771, -18.501561760859261, -5.3779009099256996],
              'yp': [-27.513774104683165, -53.76109580655033, -18.675390266299331, 48.549892868074721, 48.549892868074721, 36.765381083562914, 19.088613406795247],
              'min_Jp': 10.3703703704,
              'max_Jp': 98.5185185185}

cm_data = [[  1.73767439e-02,   4.02600908e-02,   2.95310448e-01],
       [  1.71584534e-02,   4.13770871e-02,   3.07926241e-01],
       [  1.72158465e-02,   4.20507935e-02,   3.20928617e-01],
       [  1.76773859e-02,   4.22006847e-02,   3.34335267e-01],
       [  1.87094019e-02,   4.17180112e-02,   3.48158339e-01],
       [  2.05376076e-02,   4.04058627e-02,   3.62471143e-01],
       [  2.34349552e-02,   3.81428591e-02,   3.77145387e-01],
       [  2.77192885e-02,   3.48907424e-02,   3.92046011e-01],
       [  3.38097257e-02,   3.05009834e-02,   4.07104040e-01],
       [  4.19712627e-02,   2.51932093e-02,   4.21867372e-01],
       [  5.15003371e-02,   1.92027800e-02,   4.35952988e-01],
       [  6.16496204e-02,   1.32310829e-02,   4.48707843e-01],
       [  7.19326698e-02,   7.94375821e-03,   4.59706917e-01],
       [  8.19558892e-02,   3.87382813e-03,   4.68772046e-01],
       [  9.14790411e-02,   1.30645590e-03,   4.75974814e-01],
       [  1.00502246e-01,   1.71727650e-04,   4.81587856e-01],
       [  1.08992679e-01,   4.12876582e-04,   4.85863481e-01],
       [  1.17082363e-01,   1.76877347e-03,   4.89082032e-01],
       [  1.24781781e-01,   4.11926577e-03,   4.91451362e-01],
       [  1.32183933e-01,   7.26510026e-03,   4.93154236e-01],
       [  1.39348623e-01,   1.10584019e-02,   4.94329136e-01],
       [  1.46314252e-01,   1.53852706e-02,   4.95087103e-01],
       [  1.53113296e-01,   2.01493214e-02,   4.95517370e-01],
       [  1.59772869e-01,   2.52700577e-02,   4.95691307e-01],
       [  1.66310958e-01,   3.06839587e-02,   4.95668615e-01],
       [  1.72754439e-01,   3.63300283e-02,   4.95490054e-01],
       [  1.79117803e-01,   4.21146103e-02,   4.95191753e-01],
       [  1.85411584e-01,   4.76374934e-02,   4.94803976e-01],
       [  1.91642599e-01,   5.28751868e-02,   4.94353109e-01],
       [  1.97822622e-01,   5.78537711e-02,   4.93855631e-01],
       [  2.03959023e-01,   6.25974333e-02,   4.93326580e-01],
       [  2.10058019e-01,   6.71271917e-02,   4.92778066e-01],
       [  2.16124888e-01,   7.14614033e-02,   4.92219845e-01],
       [  2.22164144e-01,   7.56161736e-02,   4.91659762e-01],
       [  2.28179677e-01,   7.96056918e-02,   4.91104114e-01],
       [  2.34174872e-01,   8.34425062e-02,   4.90557923e-01],
       [  2.40142858e-01,   8.71420933e-02,   4.90036255e-01],
       [  2.46095884e-01,   9.07101579e-02,   4.89531764e-01],
       [  2.52037390e-01,   9.41551164e-02,   4.89045491e-01],
       [  2.57969501e-01,   9.74849216e-02,   4.88579075e-01],
       [  2.63894132e-01,   1.00706712e-01,   4.88133665e-01],
       [  2.69803529e-01,   1.03831308e-01,   4.87721459e-01],
       [  2.75709139e-01,   1.06860086e-01,   4.87331128e-01],
       [  2.81613186e-01,   1.09797939e-01,   4.86961746e-01],
       [  2.87517006e-01,   1.12649629e-01,   4.86613061e-01],
       [  2.93415425e-01,   1.15422658e-01,   4.86292579e-01],
       [  2.99314308e-01,   1.18118768e-01,   4.85993852e-01],
       [  3.05217615e-01,   1.20740132e-01,   4.85712403e-01],
       [  3.11126319e-01,   1.23290040e-01,   4.85447218e-01],
       [  3.17034802e-01,   1.25774999e-01,   4.85205426e-01],
       [  3.22950410e-01,   1.28194457e-01,   4.84977563e-01],
       [  3.28875163e-01,   1.30550308e-01,   4.84760660e-01],
       [  3.34808292e-01,   1.32845756e-01,   4.84555138e-01],
       [  3.40747462e-01,   1.35084768e-01,   4.84363285e-01],
       [  3.46698960e-01,   1.37266213e-01,   4.84176178e-01],
       [  3.52663320e-01,   1.39391995e-01,   4.83992103e-01],
       [  3.58637298e-01,   1.41466164e-01,   4.83814117e-01],
       [  3.64624795e-01,   1.43488390e-01,   4.83635915e-01],
       [  3.70627638e-01,   1.45459385e-01,   4.83453731e-01],
       [  3.76644730e-01,   1.47381555e-01,   4.83267491e-01],
       [  3.82676037e-01,   1.49256584e-01,   4.83075648e-01],
       [  3.88724663e-01,   1.51084017e-01,   4.82872419e-01],
       [  3.94790642e-01,   1.52865253e-01,   4.82655942e-01],
       [  4.00872101e-01,   1.54602917e-01,   4.82426808e-01],
       [  4.06972346e-01,   1.56296090e-01,   4.82178644e-01],
       [  4.13091381e-01,   1.57945969e-01,   4.81909359e-01],
       [  4.19228239e-01,   1.59554383e-01,   4.81618106e-01],
       [  4.25384447e-01,   1.61121364e-01,   4.81300603e-01],
       [  4.31560250e-01,   1.62647771e-01,   4.80954207e-01],
       [  4.37755378e-01,   1.64134787e-01,   4.80576925e-01],
       [  4.43970389e-01,   1.65582950e-01,   4.80165557e-01],
       [  4.50205304e-01,   1.66993140e-01,   4.79717578e-01],
       [  4.56460026e-01,   1.68366290e-01,   4.79230578e-01],
       [  4.62735175e-01,   1.69702750e-01,   4.78701070e-01],
       [  4.69030054e-01,   1.71003841e-01,   4.78127393e-01],
       [  4.75344235e-01,   1.72270663e-01,   4.77507476e-01],
       [  4.81679374e-01,   1.73502642e-01,   4.76836146e-01],
       [  4.88033600e-01,   1.74701958e-01,   4.76113350e-01],
       [  4.94406302e-01,   1.75869806e-01,   4.75337202e-01],
       [  5.00799165e-01,   1.77005483e-01,   4.74502286e-01],
       [  5.07210689e-01,   1.78110857e-01,   4.73607955e-01],
       [  5.13639473e-01,   1.79187741e-01,   4.72653469e-01],
       [  5.20086420e-01,   1.80236018e-01,   4.71634462e-01],
       [  5.26551803e-01,   1.81256066e-01,   4.70547456e-01],
       [  5.33032807e-01,   1.82250907e-01,   4.69393952e-01],
       [  5.39528815e-01,   1.83221722e-01,   4.68171980e-01],
       [  5.46043271e-01,   1.84166123e-01,   4.66872680e-01],
       [  5.52571302e-01,   1.85088992e-01,   4.65501066e-01],
       [  5.59111936e-01,   1.85991864e-01,   4.64055767e-01],
       [  5.65667373e-01,   1.86873429e-01,   4.62529779e-01],
       [  5.72235936e-01,   1.87735838e-01,   4.60922754e-01],
       [  5.78814560e-01,   1.88582577e-01,   4.59236995e-01],
       [  5.85402421e-01,   1.89415146e-01,   4.57470869e-01],
       [  5.92003729e-01,   1.90230371e-01,   4.55613107e-01],
       [  5.98612165e-01,   1.91034878e-01,   4.53672199e-01],
       [  6.05226538e-01,   1.91830622e-01,   4.51647208e-01],
       [  6.11847774e-01,   1.92617583e-01,   4.49532928e-01],
       [  6.18476535e-01,   1.93395989e-01,   4.47324368e-01],
       [  6.25107790e-01,   1.94171582e-01,   4.45028203e-01],
       [  6.31740223e-01,   1.94946644e-01,   4.42643753e-01],
       [  6.38375457e-01,   1.95720628e-01,   4.40163877e-01],
       [  6.45012331e-01,   1.96495733e-01,   4.37587127e-01],
       [  6.51646388e-01,   1.97277483e-01,   4.34919532e-01],
       [  6.58276165e-01,   1.98068558e-01,   4.32160676e-01],
       [  6.64902419e-01,   1.98869481e-01,   4.29304805e-01],
       [  6.71524923e-01,   1.99681800e-01,   4.26348052e-01],
       [  6.78138534e-01,   2.00512076e-01,   4.23298541e-01],
       [  6.84741614e-01,   2.01363454e-01,   4.20156155e-01],
       [  6.91332488e-01,   2.02239189e-01,   4.16920833e-01],
       [  6.97914408e-01,   2.03137608e-01,   4.13579110e-01],
       [  7.04480745e-01,   2.04067127e-01,   4.10143522e-01],
       [  7.11029389e-01,   2.05031670e-01,   4.06614988e-01],
       [  7.17558444e-01,   2.06035013e-01,   4.02993804e-01],
       [  7.24066032e-01,   2.07080973e-01,   3.99280126e-01],
       [  7.30554316e-01,   2.08169342e-01,   3.95461407e-01],
       [  7.37016723e-01,   2.09308835e-01,   3.91551454e-01],
       [  7.43451102e-01,   2.10503717e-01,   3.87550990e-01],
       [  7.49855245e-01,   2.11758355e-01,   3.83460834e-01],
       [  7.56226880e-01,   2.13077200e-01,   3.79281901e-01],
       [  7.62564469e-01,   2.14464005e-01,   3.75012287e-01],
       [  7.68866960e-01,   2.15922092e-01,   3.70647652e-01],
       [  7.75129394e-01,   2.17458588e-01,   3.66198123e-01],
       [  7.81349229e-01,   2.19078202e-01,   3.61665167e-01],
       [  7.87523857e-01,   2.20785658e-01,   3.57050382e-01],
       [  7.93650609e-01,   2.22585675e-01,   3.52355496e-01],
       [  7.99726760e-01,   2.24482938e-01,   3.47582380e-01],
       [  8.05749525e-01,   2.26482082e-01,   3.42733045e-01],
       [  8.11717192e-01,   2.28586742e-01,   3.37803764e-01],
       [  8.17625836e-01,   2.30802299e-01,   3.32801590e-01],
       [  8.23472178e-01,   2.33133350e-01,   3.27730864e-01],
       [  8.29253278e-01,   2.35583999e-01,   3.22594224e-01],
       [  8.34966177e-01,   2.38158144e-01,   3.17394447e-01],
       [  8.40607906e-01,   2.40859441e-01,   3.12134445e-01],
       [  8.46175493e-01,   2.43691277e-01,   3.06817261e-01],
       [  8.51665978e-01,   2.46656736e-01,   3.01446059e-01],
       [  8.57076427e-01,   2.49758572e-01,   2.96024113e-01],
       [  8.62403944e-01,   2.52999180e-01,   2.90554797e-01],
       [  8.67645684e-01,   2.56380571e-01,   2.85041567e-01],
       [  8.72798873e-01,   2.59904353e-01,   2.79487947e-01],
       [  8.77860819e-01,   2.63571711e-01,   2.73897506e-01],
       [  8.82828927e-01,   2.67383395e-01,   2.68273840e-01],
       [  8.87700719e-01,   2.71339707e-01,   2.62620550e-01],
       [  8.92473843e-01,   2.75440504e-01,   2.56941214e-01],
       [  8.97146089e-01,   2.79685190e-01,   2.51239366e-01],
       [  9.01715403e-01,   2.84072744e-01,   2.45518364e-01],
       [  9.06179891e-01,   2.88601710e-01,   2.39781536e-01],
       [  9.10537847e-01,   2.93270164e-01,   2.34032436e-01],
       [  9.14787747e-01,   2.98075826e-01,   2.28274137e-01],
       [  9.18928255e-01,   3.03016050e-01,   2.22509556e-01],
       [  9.22958227e-01,   3.08087850e-01,   2.16741437e-01],
       [  9.26876716e-01,   3.13287928e-01,   2.10972337e-01],
       [  9.30682966e-01,   3.18612711e-01,   2.05204615e-01],
       [  9.34376404e-01,   3.24058412e-01,   1.99440324e-01],
       [  9.37956671e-01,   3.29620980e-01,   1.93681546e-01],
       [  9.41423579e-01,   3.35296222e-01,   1.87930037e-01],
       [  9.44777111e-01,   3.41079820e-01,   1.82187347e-01],
       [  9.48017420e-01,   3.46967355e-01,   1.76454845e-01],
       [  9.51144807e-01,   3.52954355e-01,   1.70733732e-01],
       [  9.54159720e-01,   3.59036314e-01,   1.65025073e-01],
       [  9.57062731e-01,   3.65208736e-01,   1.59329834e-01],
       [  9.59854530e-01,   3.71467154e-01,   1.53648922e-01],
       [  9.62535909e-01,   3.77807156e-01,   1.47983244e-01],
       [  9.65107749e-01,   3.84224414e-01,   1.42333768e-01],
       [  9.67571004e-01,   3.90714697e-01,   1.36701603e-01],
       [  9.69926689e-01,   3.97273892e-01,   1.31088094e-01],
       [  9.72175871e-01,   4.03898014e-01,   1.25494932e-01],
       [  9.74319651e-01,   4.10583221e-01,   1.19924290e-01],
       [  9.76359155e-01,   4.17325823e-01,   1.14378989e-01],
       [  9.78295526e-01,   4.24122283e-01,   1.08862691e-01],
       [  9.80129910e-01,   4.30969227e-01,   1.03380144e-01],
       [  9.81863449e-01,   4.37863445e-01,   9.79374729e-02],
       [  9.83497275e-01,   4.44801887e-01,   9.25425384e-02],
       [  9.85032499e-01,   4.51781667e-01,   8.72053748e-02],
       [  9.86470208e-01,   4.58800061e-01,   8.19387223e-02],
       [  9.87811458e-01,   4.65854496e-01,   7.67586717e-02],
       [  9.89057272e-01,   4.72942556e-01,   7.16854328e-02],
       [  9.90208632e-01,   4.80061968e-01,   6.67442340e-02],
       [  9.91266480e-01,   4.87210601e-01,   6.19663391e-02],
       [  9.92231715e-01,   4.94386459e-01,   5.73901352e-02],
       [  9.93105189e-01,   5.01587672e-01,   5.30621847e-02],
       [  9.93887706e-01,   5.08812493e-01,   4.90380484e-02],
       [  9.94580027e-01,   5.16059287e-01,   4.53825589e-02],
       [  9.95182860e-01,   5.23326530e-01,   4.21690964e-02],
       [  9.95696906e-01,   5.30612760e-01,   3.94678830e-02],
       [  9.96122719e-01,   5.37916703e-01,   3.74064101e-02],
       [  9.96460853e-01,   5.45237125e-01,   3.60531269e-02],
       [  9.96711825e-01,   5.52572863e-01,   3.54269395e-02],
       [  9.96876111e-01,   5.59922831e-01,   3.55487328e-02],
       [  9.96954141e-01,   5.67286007e-01,   3.64414317e-02],
       [  9.96946309e-01,   5.74661431e-01,   3.81300679e-02],
       [  9.96852971e-01,   5.82048200e-01,   4.06383420e-02],
       [  9.96674446e-01,   5.89445458e-01,   4.38607964e-02],
       [  9.96411024e-01,   5.96852395e-01,   4.77313016e-02],
       [  9.96062962e-01,   6.04268238e-01,   5.21795861e-02],
       [  9.95630494e-01,   6.11692248e-01,   5.71366577e-02],
       [  9.95113829e-01,   6.19123715e-01,   6.25386873e-02],
       [  9.94513158e-01,   6.26561954e-01,   6.83290850e-02],
       [  9.93828660e-01,   6.34006294e-01,   7.44592148e-02],
       [  9.93060500e-01,   6.41456080e-01,   8.08882326e-02],
       [  9.92208842e-01,   6.48910666e-01,   8.75824420e-02],
       [  9.91273850e-01,   6.56369407e-01,   9.45144413e-02],
       [  9.90255698e-01,   6.63831655e-01,   1.01662232e-01],
       [  9.89154576e-01,   6.71296755e-01,   1.09008382e-01],
       [  9.87970701e-01,   6.78764036e-01,   1.16539280e-01],
       [  9.86704326e-01,   6.86232806e-01,   1.24244502e-01],
       [  9.85355752e-01,   6.93702343e-01,   1.32116277e-01],
       [  9.83925345e-01,   7.01171892e-01,   1.40149057e-01],
       [  9.82413549e-01,   7.08640650e-01,   1.48339156e-01],
       [  9.80820908e-01,   7.16107758e-01,   1.56684464e-01],
       [  9.79146765e-01,   7.23573032e-01,   1.65185162e-01],
       [  9.77391299e-01,   7.31035777e-01,   1.73842231e-01],
       [  9.75556647e-01,   7.38494232e-01,   1.82656367e-01],
       [  9.73643915e-01,   7.45947228e-01,   1.91630031e-01],
       [  9.71654460e-01,   7.53393477e-01,   2.00766504e-01],
       [  9.69589946e-01,   7.60831541e-01,   2.10069825e-01],
       [  9.67452398e-01,   7.68259816e-01,   2.19544727e-01],
       [  9.65244276e-01,   7.75676503e-01,   2.29196593e-01],
       [  9.62968551e-01,   7.83079581e-01,   2.39031421e-01],
       [  9.60626214e-01,   7.90467991e-01,   2.49058201e-01],
       [  9.58213790e-01,   7.97842682e-01,   2.59291681e-01],
       [  9.55744894e-01,   8.05196625e-01,   2.69731984e-01],
       [  9.53225597e-01,   8.12526507e-01,   2.80387478e-01],
       [  9.50663151e-01,   8.19828568e-01,   2.91266966e-01],
       [  9.48055919e-01,   8.27102910e-01,   3.02390603e-01],
       [  9.45412313e-01,   8.34345175e-01,   3.13770873e-01],
       [  9.42754582e-01,   8.41545410e-01,   3.25407209e-01],
       [  9.40093046e-01,   8.48698913e-01,   3.37314276e-01],
       [  9.37424391e-01,   8.55806293e-01,   3.49526976e-01],
       [  9.34791621e-01,   8.62849999e-01,   3.62028471e-01],
       [  9.32201544e-01,   8.69826945e-01,   3.74849083e-01],
       [  9.29682437e-01,   8.76725911e-01,   3.87997035e-01],
       [  9.27270961e-01,   8.83533054e-01,   4.01472490e-01],
       [  9.24992324e-01,   8.90238933e-01,   4.15296152e-01],
       [  9.22898384e-01,   8.96825262e-01,   4.29453034e-01],
       [  9.21031702e-01,   9.03277601e-01,   4.43943693e-01],
       [  9.19444198e-01,   9.09579042e-01,   4.58754293e-01],
       [  9.18199963e-01,   9.15709936e-01,   4.73844052e-01],
       [  9.17349405e-01,   9.21655835e-01,   4.89189781e-01],
       [  9.16956694e-01,   9.27399743e-01,   5.04724177e-01],
       [  9.17072296e-01,   9.32930261e-01,   5.20384240e-01],
       [  9.17737820e-01,   9.38240220e-01,   5.36095874e-01],
       [  9.18982029e-01,   9.43327790e-01,   5.51777484e-01],
       [  9.20814269e-01,   9.48197414e-01,   5.67362678e-01],
       [  9.23233496e-01,   9.52858172e-01,   5.82766816e-01],
       [  9.26218079e-01,   9.57324052e-01,   5.97944728e-01],
       [  9.29737715e-01,   9.61611334e-01,   6.12857763e-01],
       [  9.33756053e-01,   9.65738863e-01,   6.27455410e-01],
       [  9.38229897e-01,   9.69723761e-01,   6.41746985e-01],
       [  9.43116766e-01,   9.73585106e-01,   6.55702487e-01],
       [  9.48374264e-01,   9.77339287e-01,   6.69328286e-01],
       [  9.53965277e-01,   9.80999047e-01,   6.82651346e-01],
       [  9.59848614e-01,   9.84582750e-01,   6.95638743e-01],
       [  9.65994016e-01,   9.88099611e-01,   7.08328232e-01],
       [  9.72373902e-01,   9.91558997e-01,   7.20739504e-01],
       [  9.78962279e-01,   9.94970341e-01,   7.32882716e-01],
       [  9.85736086e-01,   9.98341900e-01,   7.44769013e-01]]

PiBuRdYl = LinearSegmentedColormap.from_list('PiBuRdYl', cm_data)
PiBuRdYl_r = LinearSegmentedColormap.from_list('PiBuRdYl_r', cm_data[::-1])

# Make a clean "from <colormap> import *"
__all__ = ['PiBuRdYl', 'PiBuRdYl_r']

# For use with viscm
test_cm = PiBuRdYl

#
